<!DOCTYPE html>
<html
	 xmlns="http://www.w3.org/1999/xhtml"
	 xmlns:h="http://java.sun.com/jsf/html"
	 xmlns:p="http://primefaces.org/ui"
	 xmlns:ui="http://java.sun.com/jsf/facelets"
	 xmlns:f="http://java.sun.com/jsf/core">

 <h:body>


 <ui:composition template="/template/mainLayout.xhtml">
 
  <div id="content">
   
	 <ui:define  name="content">
	 

	

          <h:form id="cotizacionCompleta" style="font-size:12px;" onreset=""> 
   
    
    
    
    
    	 <p:panel id="pnlTablaAsignados"   style="border:0px; margin-bottom:25px; overflow:auto; font-size:12px;" >
   	 
  
          <h2>Solicitud de requerimiento</h2><br/>
          
          <h3>Tipo de cambio DOF:          
           <p:outputLabel style="color:red;" id="tc"  value="#{inventarioController.tc}"  />
           </h3>
          
         
    		  <p:fieldset legend="Responsable de compras" rendered="#{ventasController.solicitud.usuarioByIdComprador != null}">
    		  
    		   <p:panelGrid columns="3" >
     	<p:outputLabel for="asignado" value="Usuario de compras asignado:" style="font-weight: bold;font-size:14px;" />
           <p:outputLabel id="asignado"  value="#{ventasController.solicitud.usuarioByIdComprador.empleado.nombre} #{ventasController.solicitud.usuarioByIdComprador.empleado.apellidoMaterno} #{ventasController.solicitud.usuarioByIdComprador.empleado.apellidoPaterno}"  />
     </p:panelGrid>
    		  
    		  </p:fieldset>
    		  <br/>
    		  
    		    		  <p:fieldset legend="Datos de la empresa">
    <p:panel>
    
    	 <p:panelGrid columns="1">
    	 	<p:outputLabel  style="font-weight: bold;font-size:14px;" value="Suministros Herbolarios y Químicos, S.A. de C.V." />
    		<p:outputLabel  style="font-weight: bold;font-size:14px;" value="Pino 18, Las Rosas, CP 54069, Tlalnepantla de Baz, Estado de México, México" />
        </p:panelGrid>
         <p:panelGrid columns="3">
    	 	<p:outputLabel  style="font-weight: bold;font-size:14px;" value="SHQ1403107G5" />
    		<p:outputLabel  style="font-weight: bold;font-size:14px;" value="Tel: 6648 9495" />
    		<p:outputLabel  style="font-weight: bold;font-size:14px;" value="Email: ventas@shq.com.mx" />
        </p:panelGrid>
    </p:panel>
    </p:fieldset><br/>
    
    <p:fieldset legend="Datos del requerimiento">
    <p:panel>
    		
    	 <p:panelGrid columns="2">
    	   <p:outputLabel  for="fechaReq" style="font-weight: bold;font-size:14px;" value="Fecha solicitud:" />
    	 	<p:outputLabel  id="fechaReq" style="width:100%" value="#{ventasController.solicitud.fechaSol}"/>
    	    <p:outputLabel  for="folio" style="font-weight: bold;font-size:14px;" value="Requerimiento:" />
    	 	<p:outputLabel  id="folio" style="width:100%" value="#{ventasController.solicitud.id}"/>
        </p:panelGrid>
         
    </p:panel>
    </p:fieldset><br/>
    
    		   <p:fieldset legend="Datos del cliente">
    <p:panel>
    
    	 <p:panelGrid columns="6">
    		  	<p:outputLabel  for="clave" style="font-weight: bold;font-size:14px;" value="Clave del cliente:" />
    		<p:outputLabel  id="clave" style="width:100%" value="#{ventasController.solicitud.usuarioByIdExterno.idUsuario}"/>
    		<p:outputLabel  for="nombre" style="font-weight: bold;font-size:14px;" value="Cliente:" />
    		<p:outputLabel  id="nombre" style="width:100%" value="#{ventasController.solicitud.nombre} #{ventasController.solicitud.apellidoPaterno} #{ventasController.solicitud.apellidoMaterno}" />
    		<p:outputLabel  for="rfc" style="font-weight: bold;font-size:14px;" value="RFC:" />
    		<p:outputLabel  id="rfc" style="width:100%" value="#{ventasController.solicitud.rfc}"/>
    		
    		  	<p:outputLabel  for="tel" style="font-weight: bold;font-size:14px;" value="Télefono:" />
    		  	<p:outputLabel  id="tel" style="width:100%" value="#{ventasController.solicitud.telefono}" />
    		  	
    		  	<p:outputLabel  for="correo" style="font-weight: bold;font-size:14px;" value="Correo:" />
    		  	<p:outputLabel  id="correo" style="width:100%" value="#{ventasController.solicitud.correo}"/>
    		  	

        </p:panelGrid>
    </p:panel>
    </p:fieldset><br/>
    
    <p:fieldset legend="Datos del domicilio">
    <p:panel>
    
    <p:panelGrid columns="2">
    	 	<p:outputLabel  for="dirFiscal" style="font-weight: bold;font-size:14px;" value="Dirección fiscal:" />
    		<p:outputLabel  id="dirFiscal" style="width:100%" value="#{ventasController.solicitud.direccionFiscal}"/>
    		
    		<p:outputLabel  for="dirEntrega" style="font-weight: bold;font-size:14px;" value="Dirección entrega:" />
    		<p:outputLabel  id="dirEntrega" style="width:100%" value="#{ventasController.solicitud.direccionEntrega}"/>
    
    		  	

        </p:panelGrid>
        
      <ui:remove>  
      <p:panelGrid columns="2" id="pnlDomicilioGlobal" columnClasses="ui-grid-col-6,ui-grid-col-6" layout="grid" styleClass="ui-panelgrid-blank">
	  
	  
     <p:panelGrid columns="2" id="pnlDomicilio" columnClasses="ui-grid-col-4,ui-grid-col-8" layout="grid" styleClass="ui-panelgrid-blank">
      		
      		<p:outputLabel for="pais" value="País:" style="font-weight: bold;font-size:14px;"/>      		

        <p:outputLabel  id="pais" style="width:100%" value="#{ventasController.solicitud.pais}"/>
        

        <p:outputLabel   for="municipio" value="Municipio:" style="font-weight: bold;font-size:14px;" />      		
      		
       <p:outputLabel  id="municipio"  value="#{catalogosController.getMunicipio({ventasController.solicitud.municipio},{ventasController.solicitud.estado}).id.DMnpio}"/> 
        
        

         <p:outputLabel  for="cp" value="Código Postal:" style="font-weight: bold;font-size:14px;" />      		        	    
         <p:outputLabel  id="cp"  value="#{catalogosController.getUnicoCP({ventasController.solicitud.estado},{ventasController.solicitud.municipio},{ventasController.solicitud.colonia}).id.DCodigo}"/>  
        
        
          </p:panelGrid>
          
               <p:panelGrid columns="2" id="pnlDomicilio2" columnClasses="ui-grid-col-4,ui-grid-col-8" layout="grid" styleClass="ui-panelgrid-blank">

        	<p:outputLabel   for="estado" value="Estado:" style="font-weight: bold;font-size:14px;" />      		
    
                       <p:outputLabel  id="estado"  value="#{catalogosController.getEstado({ventasController.solicitud.estado}).id.DEstado}"/> 
                
                
                  		
                

      		   <p:outputLabel   for="colonia" value="Colonia:" style="font-weight: bold;font-size:14px;" />      		
      		
        
                               <p:outputLabel  id="colonia"  value="#{catalogosController.getColonia({ventasController.solicitud.colonia},{ventasController.solicitud.estado},{ventasController.solicitud.municipio}).id.DAsenta}"/> 
        
                
        <p:outputLabel for="calle" value="Calle:" style="font-weight: bold;font-size:14px;" />    
                            <p:outputLabel id="calle" size="35" value="#{ventasController.solicitud.calle}"/>
                         
        	 

        	</p:panelGrid>
        	               <p:panelGrid columns="2" id="pnlDomicilio3" columnClasses="ui-grid-col-4,ui-grid-col-8" layout="grid" styleClass="ui-panelgrid-blank">
        	
        	   <p:outputLabel for="ref" value="Referencias:" style="font-weight: bold;font-size:14px;"/>    
                            <p:outputLabel id="ref" size="35" value="#{ventasController.solicitud.referencias}"/>
                         
                         
                         </p:panelGrid>
                         
                         
                         
                         

                         <p:panelGrid columns="4" id="pnlDomicilio4" columnClasses="ui-grid-col-3,ui-grid-col-3" layout="grid" styleClass="ui-panelgrid-blank">
        	
        	  			<p:outputLabel for="numExt" value="Núm. Ext:" style="font-weight: bold;font-size:14px;" />    
                            <p:outputLabel id="numExt" size="10" value="#{ventasController.solicitud.numExt}"/>
                         
                          <p:outputLabel  value="Núm. Int:" style="font-weight: bold;font-size:14px;" />    
                           <p:outputLabel rendered="#{ventasController.solicitud.numInt != ''}" value="#{ventasController.solicitud.numInt}"/>
                           <p:outputLabel rendered="#{ventasController.solicitud.numInt == ''}"  value="-"/>
                           
     
                         </p:panelGrid>

      	</p:panelGrid> </ui:remove>
      	
    </p:panel>
    </p:fieldset><br/>
    
    <p:fieldset legend="Terminos y condiciones de entrega">
    <p:panel>
    
    	<p:panelGrid columns="8">
    	    <p:outputLabel for="dondeEntrega" value="Tipo de entrega:" style="font-weight: bold;font-size:14px;" />
    	    <p:outputLabel id="dondeEntrega" value="#{ventasController.solicitud.dondeEntregar}" />
            

    	    <p:outputLabel for="metodoPago" value="Método de pago:" style="font-weight: bold;font-size:14px;" />
    	    <p:outputLabel id="metodoPago" value="#{ventasController.solicitud.metodoPago}" />
    	    
    	    <p:outputLabel for="valor" value="Valor:" style="font-weight: bold;font-size:14px;" />
    	    <p:outputLabel id="valor" value="#{ventasController.solicitud.valor}" />
    	    
    	     <p:outputLabel for="fletera" value="Fletera:" style="font-weight: bold;font-size:14px;" />
    	    <p:outputLabel id="fletera" value="#{ventasController.solicitud.fletera}" />
            
        </p:panelGrid>
        
    	 <p:panelGrid columns="2" >
    	 
    	 
    	 <p:outputLabel for="fecha" value="Fecha máxima de entrega:" style="font-weight: bold;font-size:14px;" />
        
           <p:outputLabel id="fecha"  value="#{ventasController.solicitud.fechaEntrega}"  />
    	  </p:panelGrid>
    	 
    	 
	
        
       
    </p:panel>
    
    
    </p:fieldset>
    
    <br/>
    <p:fieldset legend="Productos de la cotización">
    	<p:panelGrid  columns="2" columnClasses="label,value" style="width:100%">
                <f:facet name="header">
                  <p:dataTable id="listaSolcitudesAsignadas" var="pro" value="#{ventasController.solicitud.productoSolCotizacions}" paginator="true" rows="10"  emptyMessage="No hay productos en esta cotización"
                   paginatorPosition="bottom"  scrollable="true"  sortOrder="descending">  
                  
                  
                   <p:column headerText="Clave" filterMatchMode="contains"
        filterStyle="display:none" >  
           		 #{pro.producto.clave}  
        	</p:column> 
        	
                    <p:column headerText="Producto" filterMatchMode="contains"
        filterStyle="display:none" >  
           		 #{pro.producto.producto}  
        	</p:column> 
        	
        	 <p:column headerText="Cantidad solicitada" filterMatchMode="contains"
        filterStyle="display:none" >  
           		 #{pro.cantidad}  
        	</p:column> 
        	
        	 <p:column headerText="IVA/IEPS" filterMatchMode="contains"
        filterStyle="display:none" >  
           		 #{pro.producto.impuesto}%  
        	</p:column>
        	
        	<p:column headerText="Acción"   rendered="#{ventasController.solicitud.usuarioByIdComprador == null}" filterMatchMode="contains"
        filterStyle="display:none" >  
           	 <p:commandButton process="listaSolcitudesAsignadas"  style="width:80%" update="cotizacionCompleta"   value="Buscar en inventario"  icon="fa fa-search" actionListener="#{ventasController.buscarProductoInventario(pro.producto)}" />        

        	</p:column> 
        
                  
                  
                 
        
                  </p:dataTable>
                   
                </f:facet>
                
 

            </p:panelGrid>
    	
    
    </p:fieldset>
	<br/>
	
	<p:fieldset legend="Productos cotizados al momento" rendered="#{not empty ventasController.listaProductosCotizados}"  id="flstProductosCotizados">
    	<p:panelGrid  columns="2" id="pnlProductosCotizados" rendered="#{not empty ventasController.listaProductosCotizados}"  columnClasses="label,value" style="width:100%">
                <f:facet name="header">
                  <p:dataTable id="listaProductosCotizados"  var="pro" value="#{ventasController.listaProductosCotizados}" paginator="true" rows="10"  emptyMessage="No hay productos en esta cotización"
                   paginatorPosition="bottom"  scrollable="true"  sortOrder="descending">  
                  
                                     <p:column headerText="Lote" filterMatchMode="contains"
        filterStyle="display:none" >  
           		 #{pro.lote}  
        	</p:column> 
                  
        	
                    <p:column headerText="Producto" filterMatchMode="contains"
        filterStyle="display:none" >  
           		 #{pro.producto.producto}  
        	</p:column> 
        	
        	 <p:column headerText="Cantidad"   filterMatchMode="contains"
        filterStyle="display:none" >  
           		 #{pro.cantidad}  
        	</p:column> 
        	
        	<p:column headerText="Acción"  rendered="#{ventasController.solicitud.usuarioByIdComprador == null}"  filterMatchMode="contains"
        filterStyle="display:none" >  
           	 <p:commandButton process="listaProductosCotizados" update="cotizacionCompleta"    icon="fa fa-trash" actionListener="#{ventasController.removerProductoCotizacion(pro)}" />        

        	</p:column> 
        	
        
   
        	

                  </p:dataTable>
                   
                </f:facet>
                
 

            </p:panelGrid>
            
    	
    
    </p:fieldset><br/>
	
	
	<p:fieldset legend="Productos en almacen" id="flstProductosAlmacen" rendered="#{ventasController.listaProductosLoteEncontrados != null}">
    	<p:panelGrid  columns="2" id="pnlProductosAlmacen" columnClasses="label,value" style="width:100%" rendered="#{ventasController.listaProductosLoteEncontrados != null}">
                <f:facet name="header">
                  <p:dataTable id="listaProductosInventario"  var="pro" value="#{ventasController.listaProductosLoteEncontrados}" paginator="true" rows="10"  emptyMessage="No hay productos en esta cotización"
                   paginatorPosition="bottom"  scrollable="true"  sortOrder="descending">  
                  
                                     <p:column headerText="Lote" filterMatchMode="contains"
        filterStyle="display:none" width="30">  
           		 #{pro.productoInvLote.id.lote}  
        	</p:column> 
                  
                   <p:column headerText="ID del producto" filterMatchMode="contains"
        filterStyle="display:none" >  
           		 #{pro.productoInvLote.id.idProducto}  
        	</p:column> 
        	
                    <p:column headerText="Producto" filterMatchMode="contains"
        filterStyle="display:none" >  
           		 #{pro.productoInvLote.id.producto}  
        	</p:column> 
        	
        	 <p:column headerText="Cantidad (kg)"  width="50" filterMatchMode="contains"
        filterStyle="display:none" >  
           		 #{pro.productoInvLote.id.cantidad}  
        	</p:column> 
        	<p:column headerText="Precio"  width="80" filterMatchMode="contains"
        filterStyle="display:none" >  
           		 #{pro.productoInvLote.id.precio}  
        	</p:column> 
        	
        	<p:column headerText="Cantidad a surtir" filterMatchMode="contains" 
        filterStyle="display:none" >  
           		 <p:inputNumber id="cantidadSurtir"  value="#{pro.cantidad}" >
           		 	<p:ajax update="" /> 
           		 </p:inputNumber>
        	</p:column> 
        	
        	<p:column headerText="Acción"    filterMatchMode="contains"
        filterStyle="display:none" rendered="#{ventasController.solicitud.usuarioByIdComprador == null}">  
           	 <p:commandButton   update="cotizacionCompleta"   value="Agregar"  icon="fa fa-plus" actionListener="#{ventasController.actualizarCantidades(pro)}" />        

        	</p:column> 
                  
                  
                 
        
                  </p:dataTable>
                   
                </f:facet>
                
        	 
 

            </p:panelGrid>
            
    	
    
    </p:fieldset>
    
      <p:panelGrid columns="1" style="float:right;margin-right:45%;" rendered="#{ventasController.solicitud.usuarioByIdComprador == null}">

                    <p:commandButton id="btnGenerar" process="cotizacionCompleta"  style="width:100%" update="cotizacionCompleta" value="Generar"  icon="fa fa-check" actionListener="#{ventasController.generarCotizacion()}" />        
   
  </p:panelGrid>
     
    </p:panel>
    
    
    
    
    
    
    
    
  
    
    <br/><br/>
    

    	
    	
    	</h:form>
<!--      </p:tab>  -->
        
<!--          <p:tab title="Crear bitacora" style="max-height:800px; overflow:auto;">     -->
 

          
<!--          </p:tab>   -->
         

<!--      </p:tabView> -->

                 
 
	 
 
	 </ui:define>
  </div>
  
		
</ui:composition>
 </h:body>
</html>